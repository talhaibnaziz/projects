
<!-- saved from url=(0051)http://www.lightoj.com/forum_viewtopic.php?topic=49 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Jan's LightOJ :: Forum :: Topic - 1108 - Instant View of Big Bang</title>
		
		<link rel="stylesheet" type="text/css" href="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/style.css">
		<script>
			function deletePost( e ) {
				var r = confirm("Are you sure you want to delete this post?");
				if( r == true ) {
					document.getElementById("content").innerHTML = "<br /><br /><br /><br /><br /><br /><h1>Deleting...</h1>";
					location.href="forum_deletepost.php?item="+e;
					return;
				}
			}
		</script>
	</head>
	<body>
<style>
div.tempMessage {
  float: left;
  font-size: 30;
  margin-top: 10px;
  margin-left: 300px;
  position: absolute;
  border: 2px solid white;
  background: yellow;
  border-radius: 5px;
  padding: 2px;
}
div.tempMessage a {
  text-decoration: underline;
  color: red;
}
</style>
<div class="topDiv">
			<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/main.png" class="topImage" style="float: left;">
                <!--<div class="tempMessage"><a href="http://lightoj.com/lightojv2/contest/215/problems" target=_blank>ACM ICPC Dhaka Regionals Online Preliminary Contest is scheduled here.</a></div>!-->
			<div class="topMenuMessage" style="display: block; float: right; padding: 50 5 0 0;">
				Server Time:
				<a class="top_link" target="_blank" href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=20161002T165707">
					Sun Oct 2, 2016 10:57 pm				</a>
			</div>
		</div>
		<div class="topMenu" align="center">
			<table width="100%">
				<tbody><tr>
					<td width="10%">
						<div class="topMenuMessage">
							&nbsp;<a class="top_link" href="http://www.lightoj.com/index.php">
								Home
							</a>
						</div>
					</td>
					<td width="10%">
						<div class="topMenuMessage">
							<a class="top_link" href="http://www.lightoj.com/volume_problemset.php">
								Volume
							</a>
						</div>
					</td>
					<td width="10%">
						<div class="topMenuMessage">
							<a class="top_link" href="http://www.lightoj.com/contest_index.php">
								Contest
							</a>
						</div>
					</td>
					<td width="10%">
						<div class="topMenuMessage">
							<a class="top_link" href="http://www.lightoj.com/article_showcategory.php">Training</a>
						</div>
					</td>
					<td width="10%">
						<div class="topMenuMessage">
							<a class="top_link" href="http://www.lightoj.com/forum_index.php">Community</a>
						</div>
					</td>
					<td width="10%">
						<div class="topMenuMessage">
							<a class="top_link" href="http://www.lightoj.com/credits_index.php">Credits</a>
						</div>
					</td>
					<td width="60%" align="right">
						<div class="topMenuMessage">
							Welcome
								<a class="top_link" href="http://www.lightoj.com/index_edituser.php">
									Talha Ibn Aziz								</a>
							(<a class="top_link" href="http://www.lightoj.com/login_logout.php">
								logout
							</a>)&nbsp;
						</div>
					</td>
				</tr>
			</tbody></table>
		</div>
		<div id="wrapper">
			<div id="content" align="center">
				<h1>Forum</h1>


				<table id="mytable3" cellspacing="0">
					<tbody><tr>
						<th class="top" style="text-align: left; border-radius: 5; border-left: 1px solid #C1DAD7;">
							<a class="user_link" href="http://www.lightoj.com/forum_index.php?item=1">Forum Index</a> &lt; <a class="user_link" href="http://www.lightoj.com/forum_index.php?item=9">LightOJ Problemset Archive</a> &lt; <a class="user_link" href="http://www.lightoj.com/forum_index.php?item=27">Volume 11</a> &lt; 						</th>
					</tr>
					<tr>
						<th class="one" style="text-align: left; font-size: 10pt; font-weight: normal; background: none; border: none; padding: 8 8 8 8;">
							<span style="border: 1px solid #C1DAD7; border-radius: 5; background: #fff; padding: 8 8 8 8;">
							<b>Topic:</b>
								<a class="colored_link" href="http://www.lightoj.com/volume_showproblem.php?problem=1108">
									1108 - Instant View of Big Bang								</a>
							</span>
						</th>
					</tr>
				</tbody></table><br><br>
				<div style="text-align: left; padding: 0 0 0 5;">
					<span class="forum_button">
						<a class="user_link" href="http://www.lightoj.com/forum_post.php?parent=49">
							New Reply
						</a>&nbsp;
					</span>
				</div>
				<br>
				<table id="mytable3" cellspacing="0">
					<tbody><tr>
						<th class="top" style="border-right: none; border-bottom-left-radius: 5px; border-top-left-radius: 5px; border-left: 1px solid #C1DAD7;">
							Message
						</th>
						<th class="top" style="border-bottom-right-radius: 5px; border-top-right-radius: 5px;">
							Author
						</th>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/bell.png" title="Announcement" style="vertical-align: bottom;">
									&nbsp;1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Sep 10, 2011 2:24 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Category: <a class="colored_link" href="http://www.lightoj.com/volume_problemcategory.php?category=Bellman%20Ford">Bellman Ford</a>.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/shield.png" title="Locked">
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1" style="color: #AA0000;" title="Administrator">
									Jane Alam Jan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 20, 2011<br>
								Total Post: 803<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Oct 27, 2011 1:05 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Is it possible to give some critical cases ? i am getting wa, advance thanks.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=887&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Oct 27, 2011 2:41 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Better to describe your idea. However, here is a simple case<br>
<br>
<b>Input:</b>
<pre class="bbcode_fixed">1

4 4
0 1 10
1 2 20
2 3 -1
3 0 -29</pre>
<b>Output:</b>
<pre class="bbcode_fixed">Case 1: impossible</pre>
Hope it helps.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=891&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1" style="color: #AA0000;" title="Administrator">
									Jane Alam Jan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 20, 2011<br>
								Total Post: 803<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Oct 27, 2011 3:44 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								This test case is ok for my code . my idea is<br>
1. run bellman ford  n -1 times and relaxed edges<br>
2. run another time to check  does it have any negetive cycle .and marked, from where this node can be visited by a dfs.<br>
3. printed all  marked no. in  ascending order.<br>
<br>
As bellman ford is single source shortest path finding algorithm i,i am very confused whom i should consider as source .<br>
In my code i haved assumed source  node who has no parent.<br>
if a cycle exists den made 0 the source.but i am not sure whether making 0 source is correct or not.<br>
<br>
Thanks<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=894&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Fri Oct 28, 2011 2:31 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								If you have a cycle, then any node on the cycle is pretty much the same thing. But before that you need to know whether you are dealing with a cycle or not. When you are sure you have found a cycle, you can surely test whether it contains a negative weight cycle, any node in this cycle can be used as a source for your bellman ford.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=912&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1019" style="color: #00AA00;" title="Moderator">
									Zobayer Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1019.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 30, 2011<br>
								Total Post: 180<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1019" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sun Nov 6, 2011 11:16 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I can find out a cycle by dfs , but how can i realize that it's a negetive or not without bellmanford ? if there any other way than ok but if not, I should use bellmanford ,and my problem is which node i should  assume  as a source ? As bellman ford is a single source shortest path algo, one of the node have to be considered as source and i can't assume  particular one as a source as problem description is:
<div class="bbcode_quote">
<div class="bbcode_quote_head">Quote:</div>
<div class="bbcode_quote_body">The scientist can start her journey from any star system</div>
</div>
.Thanks							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1257&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sun Nov 6, 2011 11:19 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								You can add a virtual source and connect all the nodes with this source.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1258&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1" style="color: #AA0000;" title="Administrator">
									Jane Alam Jan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 20, 2011<br>
								Total Post: 803<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Mon Nov 7, 2011 2:14 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								<script>
			function toggle423444842() {
				var x = '423444842a';
				var y = '423444842b';
				if( document.getElementById(x).style.display == 'block' ) {
					document.getElementById(x).style.display = 'none';
					document.getElementById(y).style.display = 'block';
				}
				else {
					document.getElementById(x).style.display = 'block';
					document.getElementById(y).style.display = 'none';
				}
			}
			function openInCompiler423444842( language ) {
				var getcode = document.getElementById('423444842c').value;

				var form = document.createElement("form");
				form.setAttribute("method", "post");
				form.setAttribute("action", "compiler_volume.php");

				var hiddenField = document.createElement("input");
				hiddenField.setAttribute("type", "hidden");
				hiddenField.setAttribute("name", "code");
				hiddenField.setAttribute("value", getcode);

				form.appendChild(hiddenField);


				if( language == "cpp" ) language = "C++";
				else if( language == "c" ) language = "C";
				else if( language == "csharp" ) language = "C#";
				else if( language == "java" ) language = "JAVA";
				else if( language == "pascal" ) language = "PASCAL";
				else if( language == "python" ) language = "PYTHON";

				var hiddenField1 = document.createElement("input");
				hiddenField1.setAttribute("type", "hidden");
				hiddenField1.setAttribute("name", "language");
				hiddenField1.setAttribute("value", language);

				form.appendChild(hiddenField1);

				document.body.appendChild(form);
				form.setAttribute("target", "_blank");
				form.submit();
			}
			</script><p></p><div style=" font: 10pt &#39;Trebuchet MS&#39;, Verdana; border: 1px solid #C1DAD7; border-radius: 5; padding: 2;">
				Code:
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="toggle423444842(); ">(Toggle Highlighting)
				</a>
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="openInCompiler423444842(&#39;cpp&#39;); ">(Open in Compiler)
				</a>
			</div><div id="423444842a" style="display: none;"><textarea id="423444842c" rows="1" readonly="yes" style="width: 100%; background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;;">removed after ac</textarea></div><div id="423444842b" style="display: block;"><div class="cpp" style="font-family:monospace;background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;"><ol><li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">removed after ac</div></li>
</ol></div></div><p></p>							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;">
										<span title="">
											Shohedul Hasan										</span>
									</a>
									on Sun Nov 13, 2011 1:14 am								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1263&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Mon Nov 7, 2011 12:34 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Check the following case.<br>
<br>
<b>Input:</b>
<pre class="bbcode_fixed">1

5 5
0 1 10
1 2 -100
3 1 -100
4 3 -100
3 4 -100</pre>
<b>Output:</b>
<pre class="bbcode_fixed">Case 1: 3 4</pre>
Hope it helps.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1269&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1" style="color: #AA0000;" title="Administrator">
									Jane Alam Jan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 20, 2011<br>
								Total Post: 803<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Mon Nov 7, 2011 5:23 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Shohedul,<br>
<br>
I think the problem with your code is that, as far as I know, Bellman Ford's algorithm can tell you if there is a negative cycle somewhere in your graph, but it can't reliably tell you where those cycles are. I struggled with this idea for a while, but after many tests, I've noticed that's the case. However, if someone has more information about this, I'd love to know.<br>
<br>
I submitted a program that has been accepted for this problem after many attempts, and my solution involves splitting the original graph in its strongly connected components (with Tarjan's algorithm), then running Bellman Ford on every SCC, and finally doing DFS to find all vertices that can reach a SCC with a negative cycle.<br>
<br>
By the way, this is one test case that fails with your code:<br>

<pre class="bbcode_fixed">1

5 6
0 2 -427
0 3 559
1 4 601
2 3 422
3 0 -597
3 4 93</pre>
<br>
Output should be:
<pre class="bbcode_fixed">Case 1: 0 2 3</pre>
<br>
Cheers							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1276&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Mon Nov 7, 2011 6:28 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								@Leonardo Boshell ,<br>
I have also noticed this and thought to solve it by SCC ,many many thanks for sharing your view, it has matched with my thinking . But as it's a problem on bellman ford ,I wanted to solve it by bellmanford to practice .however many many thanks to Boshell.<br>
<br>
@jan vai , vaiya you have told me to use a virtual source ,i used ,and the thing i realised bellmenford does not detect where is the  negetive cycle.you gave a testcase which helped me to realise this and Boshell is also saying like me.Now my question is how i could approach to this problem by bellmanford or i should solve this problem by SCC?many many thanks for your testcase.it helped me a lot ,although i have not got ac in this problem still .Thanks.<br>
<br>
i have got wa more than 10 times using bellmanford in this problem,may be for wrong procedure. would anyone kindly help me.<br>
<br>
<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1277&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Mon Nov 7, 2011 7:44 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I don't want to spoil the fun. You can use SCC, but a nice Bellman Ford solution exists. About the virtual source, its not necessary, but it's an idea and can be used, like you can add the virtual source and from this node to every other node, the edge cost is 0.<br>
<br>
Now, a useful hint, just think about this one carefully. You checked the (V-1)th iteration for Bellman Ford, now if you do one more extra iteration though the edges, if a node is relaxed in this iteration, then
<ol class="bbcode_list">
<li>either this node is in a negative cycle, or</li>
<li>this node can be traversed from some negative cycle</li>
</ol>
Hope it helps <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/smile.gif" width="15" height="17" alt=":)" title=":)" class="bbcode_smiley">.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1279&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1" style="color: #AA0000;" title="Administrator">
									Jane Alam Jan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 20, 2011<br>
								Total Post: 803<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Fri Nov 11, 2011 6:27 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I am getting still wa.i need some testcases,  changed my previous code and now idea:<br>
1. v-1 times bellmanford<br>
2. at vth time which can be relaxed ,checked wheather it is in any negetive cycle  by bfs.<br>
3 . if, it's not in a negetive cycle the nodes that are reachable from this node are same as this node and they are colored and they will not be ans;<br>
4. else every node that are reachable from this node in a transpose graph and not colored, is made ans .<br>
<br>
don't know why getting wa , tested every testcase given here,all are giving correct ans.<br>
<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1331&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Fri Nov 11, 2011 8:49 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								If I understand correctly, there's a gap in your algorithm in step 2. Let me give you an example first:<br>
<br>
Let's say you have a graph with a vertex <b>A</b> such that you can reach A traversing from a negative cycle, and you can reach a negative cycle traversing from A (i.e. A is in a path between two neg cycles), but A itself is <i>not</i> in a negative cycle. Now, let's say that the Bellman Ford routine relaxes A. Then, according to your algorithm, A will be considered as not part of the answer, but it is.<br>
<br>
So, this step:
<div class="bbcode_quote">
<div class="bbcode_quote_head">Quote:</div>
<div class="bbcode_quote_body">checked wheather it is in any negetive cycle by bfs</div>
</div>
<br>
could be more like: check if it is in any negative cycle, <i>or a negative cycle can be reached from it</i>.<br>
<br>
That's all I can think about, the rest of your algorithm looks good. I hope it helps.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1332&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Fri Nov 11, 2011 10:41 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								<script>
			function toggle121072728() {
				var x = '121072728a';
				var y = '121072728b';
				if( document.getElementById(x).style.display == 'block' ) {
					document.getElementById(x).style.display = 'none';
					document.getElementById(y).style.display = 'block';
				}
				else {
					document.getElementById(x).style.display = 'block';
					document.getElementById(y).style.display = 'none';
				}
			}
			function openInCompiler121072728( language ) {
				var getcode = document.getElementById('121072728c').value;

				var form = document.createElement("form");
				form.setAttribute("method", "post");
				form.setAttribute("action", "compiler_volume.php");

				var hiddenField = document.createElement("input");
				hiddenField.setAttribute("type", "hidden");
				hiddenField.setAttribute("name", "code");
				hiddenField.setAttribute("value", getcode);

				form.appendChild(hiddenField);


				if( language == "cpp" ) language = "C++";
				else if( language == "c" ) language = "C";
				else if( language == "csharp" ) language = "C#";
				else if( language == "java" ) language = "JAVA";
				else if( language == "pascal" ) language = "PASCAL";
				else if( language == "python" ) language = "PYTHON";

				var hiddenField1 = document.createElement("input");
				hiddenField1.setAttribute("type", "hidden");
				hiddenField1.setAttribute("name", "language");
				hiddenField1.setAttribute("value", language);

				form.appendChild(hiddenField1);

				document.body.appendChild(form);
				form.setAttribute("target", "_blank");
				form.submit();
			}
			</script><p></p><div style=" font: 10pt &#39;Trebuchet MS&#39;, Verdana; border: 1px solid #C1DAD7; border-radius: 5; padding: 2;">
				Code:
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="toggle121072728(); ">(Toggle Highlighting)
				</a>
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="openInCompiler121072728(&#39;cpp&#39;); ">(Open in Compiler)
				</a>
			</div><div id="121072728a" style="display: none;"><textarea id="121072728c" rows="1" readonly="yes" style="width: 100%; background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;;">removed after ac</textarea></div><div id="121072728b" style="display: block;"><div class="cpp" style="font-family:monospace;background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;"><ol><li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">removed after ac</div></li>
</ol></div></div><p></p>							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;">
										<span title="">
											Shohedul Hasan										</span>
									</a>
									on Sun Nov 13, 2011 1:15 am								</span>

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1333&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Nov 12, 2011 1:57 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								haha, funny function name!<br>
however, that's a huge code, can you please explain your approach a bit?							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1019" style="color: #00AA00;">
										<span title="Moderator">
											Zobayer Hasan										</span>
									</a>
									on Sat Nov 12, 2011 1:58 am								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1342&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1019" style="color: #00AA00;" title="Moderator">
									Zobayer Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1019.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 30, 2011<br>
								Total Post: 180<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1019" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Nov 12, 2011 2:16 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I haven't really checked your code, but I can give you the following test case where it fails:<br>

<pre class="bbcode_fixed">1

4 6
1 3 -735
2 0 -656
2 3 418
3 0 218
3 2 904
3 1 -21</pre>
<br>
Output should be:<br>

<pre class="bbcode_fixed">Case 1: 1 2 3</pre>
<br>
I think your code is mostly correct, but there must be a strange bug somewhere in the order of some operations or something like that, because if you swap the last two lines of that test case, your program prints the correct answer.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1344&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Nov 12, 2011 9:28 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								@Boshell , thanks for your help , i have edited my code according to your test case, now it works ,but still  i am getting wa <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/frown.gif" width="15" height="17" alt=":(" title=":(" class="bbcode_smiley"><br>
<br>
Idea:<br>
1.v-1 times bellman ford<br>
2.v th time whenever i am able to relax any node , a bfs is run from the node from which relaxation is made .<br>
3.By bfs: if  from this node negetive cycle is reachable , from any node of those negetive cycle ,a dfs on transpose graph is run and colored to be ans.<br>
<br>
In my code<br>
Graph[][] is the actual input graph<br>
G_transps[][] is the transpose of graph of input<br>
edge[] edges are stored ,a structure is used<br>
ansv[] is a flag for bfs<br>
isvisited[] is a flag for output and dfs<br>
<br>
node : a structure having three elements s,des,cost<br>
<br>
may be, i submitted more than 30 times , but stil wa  , may be ,it  was for my inefficient coding ,but thanks those who helped me.<br>
Edited code is given in my previous post. still ,hope for help.<br>
<br>
<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1353&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Nov 12, 2011 10:01 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Jane Alam Jan wrote:</div>
<div class="bbcode_quote_body">I don't want to spoil the fun. You can use SCC, but a nice Bellman Ford solution exists. About the virtual source, its not necessary, but it's an idea and can be used, like you can add the virtual source and from this node to every other node, the edge cost is 0.<br>
<br>
Now, a useful hint, just think about this one carefully. You checked the (V-1)th iteration for Bellman Ford, now if you do one more extra iteration though the edges, if a node is relaxed in this iteration, then
<ol class="bbcode_list">
<li>either this node is in a negative cycle, or</li>
<li>this node can be traversed from some negative cycle</li>
</ol>
Hope it helps <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/smile.gif" width="15" height="17" alt=":)" title=":)" class="bbcode_smiley">.</div>
</div>
Read it the two properties, what if you run bellman ford in the transpose graph, and follow the properties?							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1354&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1" style="color: #AA0000;" title="Administrator">
									Jane Alam Jan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 20, 2011<br>
								Total Post: 803<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Nov 12, 2011 10:28 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Quote:</div>
<div class="bbcode_quote_body">Read it the two properties, what if you run bellman ford in the transpose graph, and follow the properties?</div>
</div>
@jan vai<br>
I have not understand properly.sorry to say.<br>
I used the property<br>
if a node can be relaxed and negetive cycle is reachable from it then any node from negetive cycle  if i run  a dfs in transpose graph it will color every node  from which this cycle is reachable.<br>
is it not correct or enough ,should i change this strategy ? i have done according to your properties just changed slightly.<br>
Thanks<br>
<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1355&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sun Nov 13, 2011 12:10 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Hi,<br>
<br>
I commend you for your perseverence with this problem, and I thank everyone who has posted comments on this thread, since you've helped me learn a lot about the Bellman Ford algorithm I didn't know.<br>
<br>
I don't think the problem with your code is <i>inefficiency</i>, as you said. However, after studying your code a little bit, I think the problem is with how you try to detect negative cycles in the BFS routine. I think the more you try to do in your code, it's easier to overlook something and make a mistake that breaks the program, even if your general idea is correct.<br>
<br>
Consider for example the following test case:<br>

<pre class="bbcode_fixed">1

7 6
0 4 601
1 2 -642
1 0 370
4 2 -233
4 6 -403
6 1 -703</pre>
<br>
Output should be:
<pre class="bbcode_fixed">Case 1: 0 1 4 6</pre>
<br>
However, your code reports 2 as part of the answer, because the logic in the kuttabfs() function is detecting incorrectly the negative cycles.<br>
<br>
The idea that Jane suggests is pretty nice in its simplicity, and I understand it like this (I hope this is not too much of a spoiler, these ideas have been already hinted at in previous comments):<br>

<ol class="bbcode_list">
<li>Build a reverse graph (you don't really need the original graph)</li>
<li>Apply the Bellman Ford algorithm over the reverse graph (depending on your implementation, you might need to connect everything to a dummy node or not)</li>
<li>Every time BF relaxes some vertex in the last iteration, run a DFS/BFS from that vertex, because every node that is reachable from it is part of the solution.</li>
<li>That's it. Print the answer in order.</li>
</ol>
<br>
No need to try to detect where the negative cycles start or end, or do anything else fancy. I coded a solution with this approach and was accepted, although it was slower than my original solution (I guess because by dissecting the graph in the SCCs first you skip many steps in the Bellman Ford part).<br>
<br>
You're pretty close and I hope you get your program accepted soon <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/smile.gif" width="15" height="17" alt=":)" title=":)" class="bbcode_smiley">.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1384&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sun Nov 13, 2011 1:08 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Thanks to Boshell  for your unanimous and continuous helps.<br>
got ac al-last.<br>
<br>
Thanks to jan vai also .<br>
<br>
actually it's nice Bellmanford problem indeed.<br>
<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/bigsmile.gif" width="15" height="17" alt=":D" title=":D" class="bbcode_smiley"><br>
<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=1385&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1353" style="color: #006597;" title="">
									Shohedul Hasan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								BUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: September 3, 2011<br>
								Total Post: 22<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1353" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Wed Nov 16, 2011 3:08 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I had got many WA in this problem some months ago. That time the forum section was not developed. Today I have got AC on this problem reading all the replies of this post and specially with the help of Shohed Sakil.<br>
<br>
Thanks to everyone including Jan vai.  							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1341" style="color: #006597;">
										<span title="">
											Ujjal Suttra Dhar										</span>
									</a>
									on Wed Nov 16, 2011 3:11 pm								</span>

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=1454&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1341" style="color: #006597;" title="">
									Ujjal Suttra Dhar								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1341.jpg" border="1" width="100px" height="100px"><br><br>
								RUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: August 26, 2011<br>
								Total Post: 26<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1341" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Aug 18, 2012 9:19 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Is there just one cycle							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=4444&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=6144" style="color: #006597;" title="">
									tjulinfan								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								Tongji University<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=CHINA">
									China								</a><br>

								Join Date: August 8, 2012<br>
								Total Post: 1<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=6144" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Tue Aug 21, 2012 1:43 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">tjulinfan wrote:</div>
<div class="bbcode_quote_body">Is there just one cycle</div>
</div>
<br>
There can be any number of cycles (within the constraints) in the graph.<br>
<br>
When reading a problem you usually have to assume that anything that is not explicitly disallowed in the specification <i>is</i> allowed.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=4451&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Aug 23, 2012 12:48 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I need a case that fails .<br>
<script>
			function toggle724269785() {
				var x = '724269785a';
				var y = '724269785b';
				if( document.getElementById(x).style.display == 'block' ) {
					document.getElementById(x).style.display = 'none';
					document.getElementById(y).style.display = 'block';
				}
				else {
					document.getElementById(x).style.display = 'block';
					document.getElementById(y).style.display = 'none';
				}
			}
			function openInCompiler724269785( language ) {
				var getcode = document.getElementById('724269785c').value;

				var form = document.createElement("form");
				form.setAttribute("method", "post");
				form.setAttribute("action", "compiler_volume.php");

				var hiddenField = document.createElement("input");
				hiddenField.setAttribute("type", "hidden");
				hiddenField.setAttribute("name", "code");
				hiddenField.setAttribute("value", getcode);

				form.appendChild(hiddenField);


				if( language == "cpp" ) language = "C++";
				else if( language == "c" ) language = "C";
				else if( language == "csharp" ) language = "C#";
				else if( language == "java" ) language = "JAVA";
				else if( language == "pascal" ) language = "PASCAL";
				else if( language == "python" ) language = "PYTHON";

				var hiddenField1 = document.createElement("input");
				hiddenField1.setAttribute("type", "hidden");
				hiddenField1.setAttribute("name", "language");
				hiddenField1.setAttribute("value", language);

				form.appendChild(hiddenField1);

				document.body.appendChild(form);
				form.setAttribute("target", "_blank");
				form.submit();
			}
			</script><p></p><div style=" font: 10pt &#39;Trebuchet MS&#39;, Verdana; border: 1px solid #C1DAD7; border-radius: 5; padding: 2;">
				Code:
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="toggle724269785(); ">(Toggle Highlighting)
				</a>
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="openInCompiler724269785(&#39;cpp&#39;); ">(Open in Compiler)
				</a>
			</div><div id="724269785a" style="display: none;"><textarea id="724269785c" rows="1" readonly="yes" style="width: 100%; background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;;">thank u very much.....</textarea></div><div id="724269785b" style="display: block;"><div class="cpp" style="font-family:monospace;background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;"><ol><li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">thank u very much.....</div></li>
</ol></div></div><p></p>							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1077" style="color: #006597;">
										<span title="">
											Sumsuddin Shojib										</span>
									</a>
									on Fri Aug 31, 2012 7:43 pm								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=4461&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1077" style="color: #006597;" title="">
									Sumsuddin Shojib								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1077.jpg" border="1" width="100px" height="100px"><br><br>
								CUET<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: July 17, 2011<br>
								Total Post: 37<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=1077" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Aug 23, 2012 3:08 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Sumsuddin Shojib wrote:</div>
<div class="bbcode_quote_body">I need a case that fails .</div>
</div>
<br>
You can try the following:<br>
<br>
Input
<pre class="bbcode_fixed">2

1000 9
10 11 -10
11 12 -10
12 10 10
998 999 -10
999 998 9
800 12 1000
750 999 1000
750 111 -1000
111 750 1000

8 14
5 2 -318
0 1 -421
1 2 -725
4 5 428
4 0 277
3 2 454
3 5 773
6 7 110
4 5 -896
2 5 -905
1 7 577
3 7 -751
6 4 -628
3 0 565</pre>
<br>
Output
<pre class="bbcode_fixed">Case 1: 10 11 12 111 750 800 998 999
Case 2: 0 1 2 3 4 5 6</pre>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=4462&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Mon Apr 1, 2013 12:02 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Jane Alam Jan wrote:</div>
<div class="bbcode_quote_body">I don't want to spoil the fun. You can use SCC, but a nice Bellman Ford solution exists. About the virtual source, its not necessary, but it's an idea and can be used, like you can add the virtual source and from this node to every other node, the edge cost is 0.<br>
<br>
Now, a useful hint, just think about this one carefully. You checked the (V-1)th iteration for Bellman Ford, now if you do one more extra iteration though the edges, if a node is relaxed in this iteration, then
<ol class="bbcode_list">
<li>either this node is in a negative cycle, or</li>
<li>this node can be traversed from some negative cycle</li>
</ol>
Hope it helps <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/smile.gif" width="15" height="17" alt=":)" title=":)" class="bbcode_smiley">.</div>
</div>
<br>
Im getting WA because of 2. term. But i dont know how to determine if a node is traversing by some negative cycle. How can i do that efficiently?<br>
<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=8955" style="color: #006597;">
										<span title="">
											OnurYildiz										</span>
									</a>
									on Wed Apr 3, 2013 4:01 pm								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=6028&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=8955" style="color: #006597;" title="">
									OnurYildiz								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								Fatih Koleji<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=TURKEY">
									Turkey								</a><br>

								Join Date: February 20, 2013<br>
								Total Post: 16<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=8955" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Wed Apr 3, 2013 7:30 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">OnurYildiz wrote:</div>
<div class="bbcode_quote_body">Im getting WA because of 2. term. But i dont know how to determine if a node is traversing by some negative cycle. How can i do that efficiently?</div>
</div>
You don't really need to do extra work to determine if a given node is reachable from a negative cycle. Take the time to read the rest of the discussion from this forum thread. There's a summary of a simple approach (as suggested by Jan) in the message from Nov 12, 2011.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=6060&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Wed Apr 3, 2013 3:54 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I already read all posts. I understand algorithm but i couldnt figure out why BF in transpose graph works ( maybe its because my English is not very well. )<br>

<div class="bbcode_quote">
<div class="bbcode_quote_head">Quote:</div>
<div class="bbcode_quote_body">how to determine if a node is traversing by some negative cycle.</div>
</div>
<br>
finding this is okay too for me so i just asked this.<br>
<br>
<br>
edit : Got AC thanks to everybody and Leonardo Boshell specially <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/bigsmile.gif" width="15" height="17" alt=":D" title=":D" class="bbcode_smiley">							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=8955" style="color: #006597;">
										<span title="">
											OnurYildiz										</span>
									</a>
									on Wed Apr 3, 2013 10:01 pm								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=6065&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=8955" style="color: #006597;" title="">
									OnurYildiz								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								Fatih Koleji<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=TURKEY">
									Turkey								</a><br>

								Join Date: February 20, 2013<br>
								Total Post: 16<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=8955" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sun Oct 13, 2013 6:05 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I use Jane vai's suggestion to solve this problem but get wa. My code passed all the test cases in the forum.<br>
<br>
Can anyone provide more test cases?							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=6587&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=3952" style="color: #006597;" title="">
									Mia Muhammad Imran								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								Dhaka University<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: February 7, 2012<br>
								Total Post: 6<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=3952" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Tue Dec 17, 2013 6:39 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Leonardo Boshell wrote:</div>
<div class="bbcode_quote_body">Hi,<br>

<ol class="bbcode_list">
<li>Build a reverse graph (you don't really need the original graph)</li>
<li>Apply the Bellman Ford algorithm over the reverse graph (depending on your implementation, you might need to connect everything to a dummy node or not)</li>
<li>Every time BF relaxes some vertex in the last iteration, run a DFS/BFS from that vertex, because every node that is reachable from it is part of the solution.</li>
<li>That's it. Print the answer in order.</li>
</ol>
.</div>
</div>
<br>
my approach was: run bellmen over original graph and if a negetive cycle found, run dfs from source of that edge over reverse graph.<br>
is there any difference running bellmen from original and reverse graph, shouldn't i get same edges (of negetive cycle)?<br>
i got WA in this code, after reversing graph for bellman, got AC, but couldn't understand why bellmen over original graph won't work, it passes all tests in this forum.<br>
<script>
			function toggle338743496() {
				var x = '338743496a';
				var y = '338743496b';
				if( document.getElementById(x).style.display == 'block' ) {
					document.getElementById(x).style.display = 'none';
					document.getElementById(y).style.display = 'block';
				}
				else {
					document.getElementById(x).style.display = 'block';
					document.getElementById(y).style.display = 'none';
				}
			}
			function openInCompiler338743496( language ) {
				var getcode = document.getElementById('338743496c').value;

				var form = document.createElement("form");
				form.setAttribute("method", "post");
				form.setAttribute("action", "compiler_volume.php");

				var hiddenField = document.createElement("input");
				hiddenField.setAttribute("type", "hidden");
				hiddenField.setAttribute("name", "code");
				hiddenField.setAttribute("value", getcode);

				form.appendChild(hiddenField);


				if( language == "cpp" ) language = "C++";
				else if( language == "c" ) language = "C";
				else if( language == "csharp" ) language = "C#";
				else if( language == "java" ) language = "JAVA";
				else if( language == "pascal" ) language = "PASCAL";
				else if( language == "python" ) language = "PYTHON";

				var hiddenField1 = document.createElement("input");
				hiddenField1.setAttribute("type", "hidden");
				hiddenField1.setAttribute("name", "language");
				hiddenField1.setAttribute("value", language);

				form.appendChild(hiddenField1);

				document.body.appendChild(form);
				form.setAttribute("target", "_blank");
				form.submit();
			}
			</script><p></p><div style=" font: 10pt &#39;Trebuchet MS&#39;, Verdana; border: 1px solid #C1DAD7; border-radius: 5; padding: 2;">
				Code:
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="toggle338743496(); ">(Toggle Highlighting)
				</a>
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="openInCompiler338743496(&#39;cpp&#39;); ">(Open in Compiler)
				</a>
			</div><div id="338743496a" style="display: none;"><textarea id="338743496c" rows="1" readonly="yes" style="width: 100%; background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;;">// Removed after AC</textarea></div><div id="338743496b" style="display: block;"><div class="cpp" style="font-family:monospace;background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;"><ol><li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #666666; font-style: italic;">// Removed after AC</span></div></li>
</ol></div></div><p></p>							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;">
										<span title="Moderator">
											Leonardo Boshell										</span>
									</a>
									on Fri Apr 11, 2014 1:44 am								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=6731&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=3235" style="color: #006597;" title="">
									Raihan Ruhin								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/3235.jpg" border="1" width="100px" height="100px"><br><br>
								JU<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: January 4, 2012<br>
								Total Post: 20<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=3235" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Feb 20, 2014 2:20 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								A very nice problem indeed !<br>
<br>
Thanks Jan Vai, I had a lot of fun while solving it <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/smile.gif" width="15" height="17" alt=":)" title=":)" class="bbcode_smiley"><br>
<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=6852&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=3277" style="color: #006597;" title="">
									Bristy Sikder								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								Chittagong Grammar School<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: January 6, 2012<br>
								Total Post: 62<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=3277" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Apr 10, 2014 9:44 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Getting WA. Please help!<br>
<script>
			function toggle253176109() {
				var x = '253176109a';
				var y = '253176109b';
				if( document.getElementById(x).style.display == 'block' ) {
					document.getElementById(x).style.display = 'none';
					document.getElementById(y).style.display = 'block';
				}
				else {
					document.getElementById(x).style.display = 'block';
					document.getElementById(y).style.display = 'none';
				}
			}
			function openInCompiler253176109( language ) {
				var getcode = document.getElementById('253176109c').value;

				var form = document.createElement("form");
				form.setAttribute("method", "post");
				form.setAttribute("action", "compiler_volume.php");

				var hiddenField = document.createElement("input");
				hiddenField.setAttribute("type", "hidden");
				hiddenField.setAttribute("name", "code");
				hiddenField.setAttribute("value", getcode);

				form.appendChild(hiddenField);


				if( language == "cpp" ) language = "C++";
				else if( language == "c" ) language = "C";
				else if( language == "csharp" ) language = "C#";
				else if( language == "java" ) language = "JAVA";
				else if( language == "pascal" ) language = "PASCAL";
				else if( language == "python" ) language = "PYTHON";

				var hiddenField1 = document.createElement("input");
				hiddenField1.setAttribute("type", "hidden");
				hiddenField1.setAttribute("name", "language");
				hiddenField1.setAttribute("value", language);

				form.appendChild(hiddenField1);

				document.body.appendChild(form);
				form.setAttribute("target", "_blank");
				form.submit();
			}
			</script><p></p><div style=" font: 10pt &#39;Trebuchet MS&#39;, Verdana; border: 1px solid #C1DAD7; border-radius: 5; padding: 2;">
				Code:
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="toggle253176109(); ">(Toggle Highlighting)
				</a>
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="openInCompiler253176109(&#39;cpp&#39;); ">(Open in Compiler)
				</a>
			</div><div id="253176109a" style="display: none;"><textarea id="253176109c" rows="155" readonly="yes" style="width: 100%; background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;;">#include &lt;bits/stdc++.h&gt;
#define MAX 1000

using namespace std;
int m, n;
vector&lt;int&gt; adj[MAX];
vector&lt;int&gt; rev[MAX];
int year[MAX][MAX];
vector&lt;int&gt; scc;
vector&lt;int&gt; answer;
bool col[MAX];
queue&lt;int&gt; q;
void dfs();
void dfs_vis(int);
void dfs_vis2(int);
void bfs();
int bf(int);

int main()
{
    int t, caseno = 0;
    scanf("%d", &amp;t);
    while(t--)
    {
        scanf("%d %d", &amp;n, &amp;m);
        for(int i = 0; i &lt; m; i++)
        {
            int x, y, t;
            scanf("%d %d %d", &amp;x, &amp;y, &amp;t);
            adj[x].push_back(y);
            rev[y].push_back(x);
            year[x][y] = t;
        }
        memset(col, 0, sizeof(col));
        for(int i = 0; i &lt; n; i++)
            if(col[i] == 0)
                dfs_vis(i);
        memset(col, 0, sizeof(col));
        while(!q.empty())
        {
            int u = q.front();
            q.pop();
            dfs_vis2(u);
            if(scc.size() &lt; 2)
                scc.clear();
            else
            {
                int result = bf(scc[0]);
                if(result)
                    answer.insert(answer.end(), scc.begin(), scc.end());
                scc.clear();
            }
        }
        bfs();
        if(answer.size() == 0)
            printf("Case %d: impossible\n", ++caseno);
        else
        {
            sort(answer.begin(), answer.end());
            printf("Case %d:", ++caseno);
            for(int i = 0; i &lt; (int)answer.size(); i++)
                printf(" %d", answer[i]);
            printf("\n");
        }
        for(int i = 0; i &lt; n; i++)
        {
            adj[i].clear();
            rev[i].clear();
        }
        scc.clear();
        answer.clear();
    }

    return 0;
}

void dfs_vis(int src)
{
    int u = src;
    col[u] = 1;
    for(int i = 0; i &lt; (int)adj[u].size(); i++)
    {
        int v = adj[u][i];
        if(col[v] == 0)
            dfs_vis(v);
    }
    q.push(u);
}

void dfs_vis2(int src)
{
    int u = src;
    col[u] = 1;
    for(int i = 0; i &lt; (int)adj[u].size(); i++)
    {
        int v = adj[u][i];
        if(col[v] == 0)
            dfs_vis2(v);
    }
    scc.push_back(u);
}

void bfs()
{
    bool vis[MAX];
    memset(vis, false, sizeof(vis));
    queue&lt;int&gt; q;
    for(int i = 0; i &lt; (int)answer.size(); i++)
    {
        int u = answer[i];
        vis[u] = true;
        q.push(u);
    }
    while(!q.empty())
    {
        int u = q.front();
        q.pop();
        for(int i = 0; i &lt; (int)rev[u].size(); i++)
        {
            int v = rev[u][i];
            if(!vis[v])
            {
                vis[v] = true;
                answer.push_back(v);
                q.push(v);
            }
        }
    }
}

int bf(int src)
{
    int dist[MAX];
    memset(dist, 63, sizeof(dist));
    dist[src] = 0;
    for(int i = 0; i &lt; (int)scc.size() - 1; i++)
    {
        for(int j = 0; j &lt; (int)scc.size(); j++)
        {
            int u = scc[j];
            for(int k = 0; k &lt; (int)adj[u].size(); k++)
            {
                int v = adj[u][k];
                if(find(adj[u].begin(), adj[u].end(), v) == adj[u].end()) continue;
                if(dist[u] + year[u][v] &lt; dist[v])
                {
                    dist[v] = dist[u] + year[u][v];
                    if(i == (int)scc.size() - 2)
                        return 1;
                }
            }
        }
    }
    return 0;
}</textarea></div><div id="253176109b" style="display: block;"><div class="cpp" style="font-family:monospace;background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;"><ol><li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #339933;">#include &lt;bits/stdc++.h&gt;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #339933;">#define MAX 1000</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #000000; font-weight: bold;">using</span> <span style="color: #000000; font-weight: bold;">namespace</span> std<span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">int</span> m, n<span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> adj<span style="color: #009900;">[</span>MAX<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> rev<span style="color: #009900;">[</span>MAX<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">int</span> year<span style="color: #009900;">[</span>MAX<span style="color: #009900;">]</span><span style="color: #009900;">[</span>MAX<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> scc<span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">vector<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> answer<span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">bool</span> col<span style="color: #009900;">[</span>MAX<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">queue<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> q<span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> dfs<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> dfs_vis<span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> dfs_vis2<span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> bfs<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">int</span> bf<span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">int</span> main<span style="color: #009900;">(</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000ff;">int</span> t, caseno <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #000066;">scanf</span><span style="color: #009900;">(</span><span style="color: #d00000;">"%d"</span>, <span style="color: #000040;">&amp;</span>t<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">while</span><span style="color: #009900;">(</span>t<span style="color: #000040;">--</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066;">scanf</span><span style="color: #009900;">(</span><span style="color: #d00000;">"%d %d"</span>, <span style="color: #000040;">&amp;</span>n, <span style="color: #000040;">&amp;</span>m<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> m<span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> x, y, t<span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066;">scanf</span><span style="color: #009900;">(</span><span style="color: #d00000;">"%d %d %d"</span>, <span style="color: #000040;">&amp;</span>x, <span style="color: #000040;">&amp;</span>y, <span style="color: #000040;">&amp;</span>t<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; adj<span style="color: #009900;">[</span>x<span style="color: #009900;">]</span>.<span style="color: #007788;">push_back</span><span style="color: #009900;">(</span>y<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rev<span style="color: #009900;">[</span>y<span style="color: #009900;">]</span>.<span style="color: #007788;">push_back</span><span style="color: #009900;">(</span>x<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; year<span style="color: #009900;">[</span>x<span style="color: #009900;">]</span><span style="color: #009900;">[</span>y<span style="color: #009900;">]</span> <span style="color: #000080;">=</span> t<span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066;">memset</span><span style="color: #009900;">(</span>col, <span style="color: #686868;">0</span>, <span style="color: #000066;">sizeof</span><span style="color: #009900;">(</span>col<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> n<span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>col<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span> <span style="color: #000080;">==</span> <span style="color: #686868;">0</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dfs_vis<span style="color: #009900;">(</span>i<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066;">memset</span><span style="color: #009900;">(</span>col, <span style="color: #686868;">0</span>, <span style="color: #000066;">sizeof</span><span style="color: #009900;">(</span>col<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">while</span><span style="color: #009900;">(</span><span style="color: #000040;">!</span>q.<span style="color: #007788;">empty</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> u <span style="color: #000080;">=</span> q.<span style="color: #007788;">front</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #007788;">pop</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dfs_vis2<span style="color: #009900;">(</span>u<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>scc.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #000080;">&lt;</span> <span style="color: #686868;">2</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scc.<span style="color: #007788;">clear</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">else</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> result <span style="color: #000080;">=</span> bf<span style="color: #009900;">(</span>scc<span style="color: #009900;">[</span><span style="color: #686868;">0</span><span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>result<span style="color: #009900;">)</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; answer.<span style="color: #007788;">insert</span><span style="color: #009900;">(</span>answer.<span style="color: #007788;">end</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span>, scc.<span style="color: #007788;">begin</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span>, scc.<span style="color: #007788;">end</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; scc.<span style="color: #007788;">clear</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; bfs<span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>answer.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #000080;">==</span> <span style="color: #686868;">0</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066;">printf</span><span style="color: #009900;">(</span><span style="color: #d00000;">"Case %d: impossible<span style="color: #d00000; font-weight: bold;">\n</span>"</span>, <span style="color: #000040;">++</span>caseno<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">else</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sort<span style="color: #009900;">(</span>answer.<span style="color: #007788;">begin</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span>, answer.<span style="color: #007788;">end</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066;">printf</span><span style="color: #009900;">(</span><span style="color: #d00000;">"Case %d:"</span>, <span style="color: #000040;">++</span>caseno<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>answer.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066;">printf</span><span style="color: #009900;">(</span><span style="color: #d00000;">" %d"</span>, answer<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #000066;">printf</span><span style="color: #009900;">(</span><span style="color: #d00000;">"<span style="color: #d00000; font-weight: bold;">\n</span>"</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> n<span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; adj<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span>.<span style="color: #007788;">clear</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rev<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span>.<span style="color: #007788;">clear</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; scc.<span style="color: #007788;">clear</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; answer.<span style="color: #007788;">clear</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">return</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> dfs_vis<span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> src<span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000ff;">int</span> u <span style="color: #000080;">=</span> src<span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; col<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span> <span style="color: #000080;">=</span> <span style="color: #686868;">1</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span>.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> v <span style="color: #000080;">=</span> adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span><span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>col<span style="color: #009900;">[</span>v<span style="color: #009900;">]</span> <span style="color: #000080;">==</span> <span style="color: #686868;">0</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dfs_vis<span style="color: #009900;">(</span>v<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; q.<span style="color: #007788;">push</span><span style="color: #009900;">(</span>u<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> dfs_vis2<span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> src<span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000ff;">int</span> u <span style="color: #000080;">=</span> src<span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; col<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span> <span style="color: #000080;">=</span> <span style="color: #686868;">1</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span>.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> v <span style="color: #000080;">=</span> adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span><span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>col<span style="color: #009900;">[</span>v<span style="color: #009900;">]</span> <span style="color: #000080;">==</span> <span style="color: #686868;">0</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dfs_vis2<span style="color: #009900;">(</span>v<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; scc.<span style="color: #007788;">push_back</span><span style="color: #009900;">(</span>u<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">void</span> bfs<span style="color: #009900;">(</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">{</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000ff;">bool</span> vis<span style="color: #009900;">[</span>MAX<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #000066;">memset</span><span style="color: #009900;">(</span>vis, <span style="color: #000000; font-weight: bold;">false</span>, <span style="color: #000066;">sizeof</span><span style="color: #009900;">(</span>vis<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; queue<span style="color: #000080;">&lt;</span><span style="color: #0000ff;">int</span><span style="color: #000080;">&gt;</span> q<span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>answer.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> u <span style="color: #000080;">=</span> answer<span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; vis<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span> <span style="color: #000080;">=</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #007788;">push</span><span style="color: #009900;">(</span>u<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">while</span><span style="color: #009900;">(</span><span style="color: #000040;">!</span>q.<span style="color: #007788;">empty</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> u <span style="color: #000080;">=</span> q.<span style="color: #007788;">front</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #007788;">pop</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>rev<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span>.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> v <span style="color: #000080;">=</span> rev<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span><span style="color: #009900;">[</span>i<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span><span style="color: #000040;">!</span>vis<span style="color: #009900;">[</span>v<span style="color: #009900;">]</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vis<span style="color: #009900;">[</span>v<span style="color: #009900;">]</span> <span style="color: #000080;">=</span> <span style="color: #000000; font-weight: bold;">true</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; answer.<span style="color: #007788;">push_back</span><span style="color: #009900;">(</span>v<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; q.<span style="color: #007788;">push</span><span style="color: #009900;">(</span>v<span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">}</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp;</div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #0000ff;">int</span> bf<span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> src<span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #0000ff;">int</span> dist<span style="color: #009900;">[</span>MAX<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #000066;">memset</span><span style="color: #009900;">(</span>dist, <span style="color: #686868;">63</span>, <span style="color: #000066;">sizeof</span><span style="color: #009900;">(</span>dist<span style="color: #009900;">)</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; dist<span style="color: #009900;">[</span>src<span style="color: #009900;">]</span> <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> i <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> i <span style="color: #000080;">&lt;</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>scc.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #000040;">-</span> <span style="color: #686868;">1</span><span style="color: #008080;">;</span> i<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> j <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> j <span style="color: #000080;">&lt;</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>scc.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span> j<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> u <span style="color: #000080;">=</span> scc<span style="color: #009900;">[</span>j<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">for</span><span style="color: #009900;">(</span><span style="color: #0000ff;">int</span> k <span style="color: #000080;">=</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span> k <span style="color: #000080;">&lt;</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span>.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #008080;">;</span> k<span style="color: #000040;">++</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #0000ff;">int</span> v <span style="color: #000080;">=</span> adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span><span style="color: #009900;">[</span>k<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>find<span style="color: #009900;">(</span>adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span>.<span style="color: #007788;">begin</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span>, adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span>.<span style="color: #007788;">end</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span>, v<span style="color: #009900;">)</span> <span style="color: #000080;">==</span> adj<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span>.<span style="color: #007788;">end</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span><span style="color: #009900;">)</span> <span style="color: #009900;">continue</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>dist<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span> <span style="color: #000040;">+</span> year<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span><span style="color: #009900;">[</span>v<span style="color: #009900;">]</span> <span style="color: #000080;">&lt;</span> dist<span style="color: #009900;">[</span>v<span style="color: #009900;">]</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">{</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dist<span style="color: #009900;">[</span>v<span style="color: #009900;">]</span> <span style="color: #000080;">=</span> dist<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span> <span style="color: #000040;">+</span> year<span style="color: #009900;">[</span>u<span style="color: #009900;">]</span><span style="color: #009900;">[</span>v<span style="color: #009900;">]</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">if</span><span style="color: #009900;">(</span>i <span style="color: #000080;">==</span> <span style="color: #009900;">(</span><span style="color: #0000ff;">int</span><span style="color: #009900;">)</span>scc.<span style="color: #007788;">size</span><span style="color: #009900;">(</span><span style="color: #009900;">)</span> <span style="color: #000040;">-</span> <span style="color: #686868;">2</span><span style="color: #009900;">)</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">return</span> <span style="color: #686868;">1</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; &nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">}</span></div></li>
<li style="font-weight: normal; vertical-align:top;"><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;">&nbsp; &nbsp; <span style="color: #009900;">return</span> <span style="color: #686868;">0</span><span style="color: #008080;">;</span></div></li>
<li style="font-weight: bold; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #009900;">}</span></div></li>
</ol></div></div><p></p>							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=6947&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=9175" style="color: #006597;" title="">
									HM Mehrab								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								American International University - Bangladesh<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: March 6, 2013<br>
								Total Post: 10<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=9175" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Fri Apr 11, 2014 1:43 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Raihan Ruhin wrote:</div>
<div class="bbcode_quote_body">my approach was: run bellmen over original graph and if a negetive cycle found, run dfs from source of that edge over reverse graph.<br>
is there any difference running bellmen from original and reverse graph, shouldn't i get same edges (of negetive cycle)?</div>
</div>
There is a difference. When you can find a node for which relaxation is possible in Bellman-Ford's last iteration, it doesn't necessarily mean that such node is part of a negative cycle. It means that the node <i>is reachable</i> from a negative cycle. Check the first two cases below, for example.<br>
<br>

<div class="bbcode_quote">
<div class="bbcode_quote_head">HM Mehrab wrote:</div>
<div class="bbcode_quote_body">Getting WA. Please help!</div>
</div>
Check the two last cases below.<br>
<br>
- - -<br>
<br>
Input
<pre class="bbcode_fixed">4

4 4
2 3 -30
0 2 5
0 1 -10
1 0 -20

6 8
3 1 -18
3 5 -29
1 2 -47
5 1 -8
0 4 -85
0 1 99
3 4 -89
4 3 -57

2 2
1 0 -7
0 1 48

6 8
4 3 -96
5 0 -28
2 1 -33
5 1 -86
3 1 -40
2 0 -2
1 2 36
5 4 -43</pre>
Output
<pre class="bbcode_fixed">Case 1: 0 1
Case 2: 0 3 4
Case 3: impossible
Case 4: impossible</pre>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=6952&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Wed Jun 11, 2014 11:34 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Getting WA for the problem, My approach is , at last iteration of bellman ford if we can relax, then traceback the predecessor tree. When a node already found in this process is found again , pop the stack upto that node and mark the nodes visited as cycles. at last do dfs on a transpose graph from each of the node of the cycle. Here is my code. <a href="http://ideone.com/F99DK1" class="bbcode_url">http://ideone.com/F99DK1</a>							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=8594" style="color: #006597;">
										<span title="">
											Tamim Addari										</span>
									</a>
									on Wed Jun 11, 2014 11:34 am								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=7125&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=8594" style="color: #006597;" title="">
									Tamim Addari								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								Dhaka University<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: January 24, 2013<br>
								Total Post: 11<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=8594" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Jun 12, 2014 1:42 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Tamim Addari wrote:</div>
<div class="bbcode_quote_body">Getting WA for the problem</div>
</div>
Try:<br>
<br>
Input
<pre class="bbcode_fixed">2

4 6
3 1 -16
0 2 32
2 3 55
1 3 -22
2 0 -80
2 1 15

6 8
3 4 -99
1 3 95
3 0 -97
5 2 -27
4 1 -71
2 5 -36
1 5 -26
0 3 -96</pre>
Output
<pre class="bbcode_fixed">Case 1: 0 1 2 3
Case 2: 0 1 2 3 4 5</pre>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=7129&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Jun 12, 2014 11:33 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Thanks Leonardo Boshell  , I wasted time trying to find the vertices on the negative cycle and then doing dfs from them . I know now this problem is NP-complete. So I basically wasted the time. I will try to find another approach.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=7132&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=8594" style="color: #006597;" title="">
									Tamim Addari								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								Dhaka University<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: January 24, 2013<br>
								Total Post: 11<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=8594" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Jul 17, 2014 2:46 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								If your code passes all the test cases posted in this thread but still you get wrong answers you may run your program against the following input <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/bigsmile.gif" width="15" height="17" alt=":D" title=":D" class="bbcode_smiley"><br>

<pre class="bbcode_fixed">1

9 10
1 2 1
3 2 2
2 3 3
3 2 4
7 3 3
7 5 2
5 7 2
5 6 2
6 5 -3
8 6 2</pre>
<br>
<br>
<br>
Accepted output:<br>

<pre class="bbcode_fixed">Case 1: 5 6 7 8</pre>
<br>
<br>
<br>
							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=10964" style="color: #006597;">
										<span title="">
											Bishwajit Purkaystha										</span>
									</a>
									on Thu Jul 17, 2014 2:49 am								</span>

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=7274&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=10964" style="color: #006597;" title="">
									Bishwajit Purkaystha								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/10964.jpg" border="1" width="100px" height="100px"><br><br>
								Shahjalal University of Science and Technology<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: July 15, 2013<br>
								Total Post: 4<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=10964" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Dec 25, 2014 3:41 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Please help me find out why I'm getting wrong answer!<br>
<script>
			function toggle881142456() {
				var x = '881142456a';
				var y = '881142456b';
				if( document.getElementById(x).style.display == 'block' ) {
					document.getElementById(x).style.display = 'none';
					document.getElementById(y).style.display = 'block';
				}
				else {
					document.getElementById(x).style.display = 'block';
					document.getElementById(y).style.display = 'none';
				}
			}
			function openInCompiler881142456( language ) {
				var getcode = document.getElementById('881142456c').value;

				var form = document.createElement("form");
				form.setAttribute("method", "post");
				form.setAttribute("action", "compiler_volume.php");

				var hiddenField = document.createElement("input");
				hiddenField.setAttribute("type", "hidden");
				hiddenField.setAttribute("name", "code");
				hiddenField.setAttribute("value", getcode);

				form.appendChild(hiddenField);


				if( language == "cpp" ) language = "C++";
				else if( language == "c" ) language = "C";
				else if( language == "csharp" ) language = "C#";
				else if( language == "java" ) language = "JAVA";
				else if( language == "pascal" ) language = "PASCAL";
				else if( language == "python" ) language = "PYTHON";

				var hiddenField1 = document.createElement("input");
				hiddenField1.setAttribute("type", "hidden");
				hiddenField1.setAttribute("name", "language");
				hiddenField1.setAttribute("value", language);

				form.appendChild(hiddenField1);

				document.body.appendChild(form);
				form.setAttribute("target", "_blank");
				form.submit();
			}
			</script><p></p><div style=" font: 10pt &#39;Trebuchet MS&#39;, Verdana; border: 1px solid #C1DAD7; border-radius: 5; padding: 2;">
				Code:
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="toggle881142456(); ">(Toggle Highlighting)
				</a>
				<a class="user_link" style="cursor: pointer; color: #c75f3e;" onclick="openInCompiler881142456(&#39;cpp&#39;); ">(Open in Compiler)
				</a>
			</div><div id="881142456a" style="display: none;"><textarea id="881142456c" rows="1" readonly="yes" style="width: 100%; background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;;">// Removed after AC</textarea></div><div id="881142456b" style="display: block;"><div class="cpp" style="font-family:monospace;background: #fff; max-height: 300px; overflow:auto; border: 1px solid #C1DAD7; border-radius: 5; padding: 0 0 0 10px;"><ol><li style="font-weight: normal; vertical-align:top; background: #F5FAFA "><div style="font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;"><span style="color: #666666; font-style: italic;">// Removed after AC</span></div></li>
</ol></div></div><p></p>							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;">
										<span title="Moderator">
											Leonardo Boshell										</span>
									</a>
									on Sat Dec 27, 2014 3:29 pm								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=7781&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=19258" style="color: #006597;" title="">
									Nguyn Vn T Thin								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								FPT University<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=VIET%20NAM">
									Viet Nam								</a><br>

								Join Date: October 4, 2014<br>
								Total Post: 16<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=19258" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Fri Dec 26, 2014 2:02 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Nguyn Vn T Thin wrote:</div>
<div class="bbcode_quote_body">Please help me find out why I'm getting wrong answer!</div>
</div>
<br>
Your code doesn't match the sample I/O							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;">
										<span title="Moderator">
											Leonardo Boshell										</span>
									</a>
									on Sat Dec 27, 2014 6:14 am								</span>

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=7786&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=8594" style="color: #006597;" title="">
									Tamim Addari								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								Dhaka University<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: January 24, 2013<br>
								Total Post: 11<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=8594" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Fri Dec 26, 2014 5:21 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								<b></b>
<div class="bbcode_quote">
<div class="bbcode_quote_head">Tamim Addari wrote:</div>
<div class="bbcode_quote_body"><br>
Your code doesn't match the sample I/O</div>
</div>
<br>
<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/9UO6YA.png" alt="9UO6YA.png" class="bbcode_img"><br>
<br>
I really appreciate your help. However, as you can see there is another answer for the first case in the sample I/O:<br>
Case 1: 1 2<br>
Do you have any other ideas why I'm getting WA?							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=7787&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=19258" style="color: #006597;" title="">
									Nguyn Vn T Thin								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								FPT University<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=VIET%20NAM">
									Viet Nam								</a><br>

								Join Date: October 4, 2014<br>
								Total Post: 16<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=19258" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Dec 27, 2014 6:16 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Nguyn Vn T Thin wrote:</div>
<div class="bbcode_quote_body">I really appreciate your help. However, as you can see there is another answer for the first case in the sample I/O:<br>
Case 1: 1 2<br>
Do you have any other ideas why I'm getting WA?</div>
</div>
The answer you propose is not correct, my friend. Notice that the problem statement is asking for a list of <b>all</b> the nodes from which you can reach a negative cycle.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=7798&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=1790" style="color: #00AA00;" title="Moderator">
									Leonardo Boshell								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/1790.jpg" border="1" width="100px" height="100px"><br><br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=COLOMBIA">
									Colombia								</a><br>

								Join Date: October 25, 2011<br>
								Total Post: 1182<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=1790" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sat Dec 27, 2014 10:36 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Leonardo Boshell wrote:</div>
<div class="bbcode_quote_body">
<div class="bbcode_quote">
<div class="bbcode_quote_head">Nguyn Vn T Thin wrote:</div>
<div class="bbcode_quote_body">I really appreciate your help. However, as you can see there is another answer for the first case in the sample I/O:<br>
Case 1: 1 2<br>
Do you have any other ideas why I'm getting WA?</div>
</div>
The answer you propose is not correct, my friend. Notice that the problem statement is asking for a list of <b>all</b> the nodes from which you can reach a negative cycle.</div>
</div>
<br>
Boshell, thank you very much. I got AC.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=7800&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=19258" style="color: #006597;" title="">
									Nguyn Vn T Thin								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								FPT University<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=VIET%20NAM">
									Viet Nam								</a><br>

								Join Date: October 4, 2014<br>
								Total Post: 16<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=19258" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Sun Jun 7, 2015 7:24 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I tried all the test cases above ( Thanks! <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/bigsmile.gif" width="15" height="17" alt=":D" title=":D" class="bbcode_smiley"> )  and got correct answer.But still WA : (<br>
My approach is like this:<br>
1)  dfs to detect negative circle, if find one, add a point which is on that circle to seed<br>
2)  use the seed to dfs on reverse graph<br>
<a href="http://paste.ubuntu.com/11626010/" class="bbcode_url">link to my code</a><br>
I want to know if there is any problem with this idea?							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=8487&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=24938" style="color: #006597;" title="">
									slowlight93								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								CQUPT<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=CHINA">
									China								</a><br>

								Join Date: May 20, 2015<br>
								Total Post: 1<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=24938" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Wed Jun 29, 2016 8:34 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								I got AC in this problem.<br>
then i looked some solution of others<br>
and one thing wondered me.<br>
they relaxed path atmost 12 times.<br>
then they declare it as negative cycle.<br>
i tried 12 or above works, but less than 12 don't work.<br>
My question is how to determine 12 from limits.<br>
or this is just check and try.							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=32911" style="color: #006597;">
										<span title="">
											ikramul										</span>
									</a>
									on Wed Jun 29, 2016 8:35 pm								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=9115&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=32911" style="color: #006597;" title="">
									ikramul								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								University of Dhaka<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: April 3, 2016<br>
								Total Post: 2<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=32911" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Jul 7, 2016 1:17 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								Thanks , learnt something new and the previous forum posts are really helpful <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/smile.gif" width="15" height="17" alt=":)" title=":)" class="bbcode_smiley">							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=9124&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=21445" style="color: #006597;" title="">
									Shahariar Shibli								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								AUST<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: January 6, 2015<br>
								Total Post: 2<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=21445" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="two" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Thu Jul 7, 2016 1:29 am								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								
<div class="bbcode_quote">
<div class="bbcode_quote_head">Bishwajit Purkaystha wrote:</div>
<div class="bbcode_quote_body">If your code passes all the test cases posted in this thread but still you get wrong answers you may run your program against the following input <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/bigsmile.gif" width="15" height="17" alt=":D" title=":D" class="bbcode_smiley"><br>

<pre class="bbcode_fixed">1

9 10
1 2 1
3 2 2
2 3 3
3 2 4
7 3 3
7 5 2
5 7 2
5 6 2
6 5 -3
8 6 2</pre>
<br>
<br>
<br>
<br>
Accepted output:<br>

<pre class="bbcode_fixed">Case 1: 5 6 7 8</pre>
<br>
<br>
</div>
</div>
<br>
Thanks . The test case saved me . <img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/smile.gif" width="15" height="17" alt=":)" title=":)" class="bbcode_smiley">							</div>
							<div style="text-align:right; padding: 20 8 5 0;">
								<span style="float: left;">
									Last edited by
									<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=21445" style="color: #006597;">
										<span title="">
											Shahariar Shibli										</span>
									</a>
									on Thu Jul 7, 2016 1:31 am								</span>

								&nbsp;<a class="user_link_two" href="http://www.lightoj.com/forum_post.php?quote=9125&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="two" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=21445" style="color: #006597;" title="">
									Shahariar Shibli								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								AUST<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=BANGLADESH">
									Bangladesh								</a><br>

								Join Date: January 6, 2015<br>
								Total Post: 2<br> <br>

								<a class="user_link_two" href="http://www.lightoj.com/index_composemsg.php?users=21445" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
					<tr>
						<td style="font-size: 3pt;">
							&nbsp;
						</td>
					</tr>
					<tr>
						<th class="one" style="vertical-align: top; border: 1px solid #C1DAD7; border-radius: 5 0 0 5; border-right: none;">
							<div style="padding: 0 0 30 0;">
								<span class="forum_title" style="float: left;">
									<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/page.png" title="Regular Post" style="vertical-align: bottom;">
									&nbsp;Re: 1108 - Instant View of Big Bang								</span>
								<span style="float: right; padding: 0 8 0 0;">
									<span style="text-transform: uppercase; color: #0B2161;">
										Post Time:
									</span>
									Wed Sep 21, 2016 2:49 pm								</span>
							</div>
							<div style="padding: 5 8 5 0; text-align: justify; font-size: 10pt; font-weight: normal; border-right: 1px dashed #C1DAD7; min-height: 180px;">
								What is the significance of using bellman ford on reverse graph ? Can anyone explain this point ? 							</div>
							<div style="text-align:right; padding: 20 8 5 0;">

								&nbsp;<a class="user_link_one" href="http://www.lightoj.com/forum_post.php?quote=9209&amp;parent=49">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/comments.png" title="Quote">
								</a>&nbsp;
							</div>
						</th>
						<td class="one" width="150px" style="vertical-align: top; border-top: 1px solid #C1DAD7; border-radius: 0 5 5 0;">
							<div>
								<a class="forum_link" href="http://www.lightoj.com/volume_userstat.php?user_id=37907" style="color: #006597;" title="">
									monera								</a>
							</div>
							<div style="padding: 10 0 5 0;">
								<img src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/none.jpg" border="1" width="100px" height="100px"><br><br>
								IIIT,Gwalior<br>
								<a class="forum_link" href="http://www.lightoj.com/volume_country_ranklist.php?country=INDIA">
									India								</a><br>

								Join Date: September 8, 2016<br>
								Total Post: 1<br> <br>

								<a class="user_link_one" href="http://www.lightoj.com/index_composemsg.php?users=37907" title="Send Personal Message">
									<img class="buttons" src="./Jan&#39;s LightOJ __ Forum __ Topic - 1108 - Instant View of Big Bang_files/email.png" style="padding: 0 0 0 0;">
								</a>
							</div>
						</td>
					</tr>
				</tbody></table>
				<br>
				<div style="text-align: left; padding: 0 0 0 5;">
					<span class="forum_button">
						<a class="user_link" href="http://www.lightoj.com/forum_post.php?parent=49">
							New Reply
						</a>&nbsp;
					</span>
				</div>
			</div>
		</div>
<div id="navigation">
	<div class="navcontainer">
		<ul class="navlist">
			<li class="menutitle">Community</li>

			<li>
				<a href="http://www.lightoj.com/community_index.php">
					Community Home
				</a>
			</li>
			<li>
				<a href="http://www.lightoj.com/chatbox_index.php">
					Main Chat Room
				</a>
			</li>
			<li id="active">
				<a id="current" href="http://www.lightoj.com/forum_index.php">
					Forum
				</a>
			</li>
			<li class="menubottom">&nbsp;</li>
		</ul>
	</div>
</div>
<div class="bottomDiv" align="center">
	<table width="100%">
		<tbody><tr>
			<td width="50%">
				<div class="midMessage">
					Developed and Maintained by
					<br><b>JANE ALAM JAN</b>
				</div>

			</td>
			<td width="50%">
				<div class="midMessage">
					Copyright  2012
					<br><b>LightOJ, Jane Alam Jan</b>
				</div>

			</td>
		</tr>
	</tbody></table>
</div>
	

</body></html>